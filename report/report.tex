\input{macros_TD}

\lhead{Tom Cornebize}
\chead{\textbf{TP Cryptography}}
\rhead{28/02/2015}



\hypersetup{
    pdftitle={TP Cryptography},
    pdfauthor={Tom Cornebize}
}

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{enumerate}[label=\textbf{\arabic*})]
    \setlength\itemsep{2em}
    \item See source code.

    \item
        \[
        \bordermatrix{
        & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15\cr
        0 & 16 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8 & 8\cr
        1 & 8 & 10 & 8 & 6 & 8 & 14 & 8 & 10 & 10 & 8 & 6 & 8 & 6 & 8 & 10 & 8\cr
        2 & 8 & 4 & 8 & 8 & 6 & 10 & 6 & 6 & 8 & 8 & 4 & 8 & 10 & 10 & 6 & 10\cr
        3 & 8 & 6 & 8 & 6 & 6 & 8 & 6 & 8 & 10 & 8 & 10 & 8 & 8 & 10 & 8 & 2\cr
        4 & 8 & 10 & 8 & 10 & 8 & 6 & 8 & 6 & 14 & 8 & 6 & 8 & 10 & 8 & 10 & 8\cr
        5 & 8 & 8 & 4 & 8 & 8 & 8 & 12 & 8 & 8 & 12 & 8 & 8 & 8 & 12 & 8 & 8\cr
        6 & 8 & 10 & 4 & 10 & 10 & 8 & 6 & 8 & 6 & 4 & 6 & 8 & 8 & 10 & 8 & 6\cr
        7 & 8 & 8 & 8 & 8 & 10 & 10 & 10 & 2 & 8 & 8 & 8 & 8 & 6 & 6 & 6 & 6\cr
        8 & 8 & 4 & 6 & 6 & 10 & 6 & 8 & 8 & 8 & 8 & 6 & 10 & 6 & 6 & 12 & 8\cr
        9 & 8 & 10 & 6 & 8 & 2 & 8 & 8 & 6 & 6 & 8 & 8 & 10 & 8 & 6 & 10 & 8\cr
        10 & 8 & 8 & 10 & 10 & 8 & 8 & 10 & 10 & 8 & 8 & 6 & 14 & 8 & 8 & 6 & 6\cr
        11 & 8 & 6 & 10 & 12 & 8 & 10 & 10 & 8 & 6 & 8 & 8 & 6 & 10 & 8 & 12 & 6\cr
        12 & 8 & 6 & 6 & 8 & 6 & 8 & 12 & 10 & 10 & 4 & 8 & 6 & 8 & 6 & 6 & 8\cr
        13 & 8 & 8 & 10 & 10 & 6 & 6 & 8 & 8 & 8 & 8 & 6 & 6 & 2 & 10 & 8 & 8\cr
        14 & 8 & 6 & 6 & 12 & 8 & 10 & 6 & 8 & 10 & 8 & 12 & 10 & 6 & 8 & 8 & 10\cr
        15 & 8 & 8 & 10 & 6 & 8 & 8 & 10 & 6 & 8 & 4 & 10 & 10 & 8 & 12 & 10 & 10\cr
        }
        \]
    \item
    The probability the farthest from $\frac{1}{2}$ is $p_{0, 0} = 1$.

    Then the ouples $(a, b)$ with probability $p_{a, b} = \frac{1}{2} \pm \frac{6}{16}$ are:

    $(1, 5), (3, 15), (4, 8), (7, 7), (9, 4), (10, 11), (13, 12)$

    \item
    Notice that we have $x \cdot (a \oplus b) = (x \oplus a)\cdot(x \oplus b)$
    Take $(a, b) = (13, 12) = (1101_2, 1100_2)$. We have $p_{13, 12} = 2$.

    Let $A = 1101\underbrace{0\dots0}_{28}$ and $B = 1100\underbrace{0\dots0}_{28}$.

    Fix $K_0, K_1$. Take $m \hookleftarrow \cU\left(\zo^{32}\right)$

    \begin{align*}
        \prob{A\cdot m = P(B)\cdot x_1} &= \prob{A\cdot m = P(B) \cdot (P(S(m \oplus K_0))\oplus K_1)} && \text{by definition}\\
            &= \prob{A\cdot m = B \cdot (S(m \oplus K_0)\oplus K'_1)} && \text{since }P(x) \cdot P(y) = x \cdot y\\
            &= \prob{A\cdot m = (B \cdot S(m \oplus K_0))\oplus (B \cdot K'_1)} && \text{by distributivity}\\
    \end{align*}
\end{enumerate}

\end{document}
